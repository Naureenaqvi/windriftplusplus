# WinDrift++

[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Paper: IEEE TAI 2023](https://img.shields.io/badge/Paper-IEEE%20TAI%202023-red.svg)](https://doi.org/10.1109/TAI.2023.3293657)

Python implementation of **WinDrift++** â€” a diversified detector for concept drift.

> N. Naqvi, S. u. Rehman, and M. Z. Islam, â€œWindrift++:a diversified detector for concept drift,â€ IEEE Transactions on Artificial Intelligence, pp. 1â€“16, 2025.
---
## ğŸ“„ Abstract
With the rise of hyperconnectivity, vast amounts of time series data are generated by applications, many of which are business-critical and are used by incremental learning models to make informed decisions. A key requirement for such models is the ability to detect concept drift changes in the statistical characteristics of data over time. A recent method, WinDrift (WD), effectively detects drift when only a single statistical characteristic changes. However, real-world datasets often exhibit changes across multiple characteristics simultaneously, requiring a more robust detection approach. We propose WinDrift++ (WD++), a novel method that extends WD by employing a committee of statistical tests rather than a single test. This enhances robustness and accuracy in detecting diverse types of drift. WD++ retains the efficient windowing strategy of WD while improving reliability across a broader range of scenarios. We evaluate WD++ on 22 synthetic and 8 real-world datasets, where it consistently outperforms WD and other state-of-the-art detectors. 

Code and datasets are available on https://github.com/naureenaqvi/windriftplusplus.

---

## ğŸ’¡ Impact Statement
Businesses in todayâ€™s dynamic environment are seeking methods to respond to constantly evolving trends in an agile and timely manner. A major challenge faced by these businesses is the ability to detect change in emerging concepts, enabling them to use strategies for incremental learning. Concept drift detection is a well-known area of consideration in the design of incremental learning models. A drift detector is generally perceived as an essential component of a learning model. We present an advanced drift detection method _WinDrift++ (WD++)_ utilising a committee of multiple statistical tests rather than a single test. The proposed method enhances the reliability, robustness, and efficiency of drift detection. _WD++_ has been rigorously evaluated on 22 synthetic and 8 real datasets. It demonstrates superior performance in terms of drift detection accuracy and resource utilisation. The code and synthetic datasets used in this work will be made available via GitHub for the benefit of the research and business community. Our drift detector is suitable for deployment with minimal modifications (with appropriate context and attention) to support real-world incremental learning models across various domains of knowledge.

---

## Algorithm Overview

WinDrift++ compares data distributions across time windows using five statistical tests:

| Test | Statistic | Detects |
|---|---|---|
| Kolmogorovâ€“Smirnov (KS) | Max CDF difference | Location shifts |
| Kuiper | Combined max +/âˆ’ deviation | Asymmetric shifts |
| CramÃ©râ€“von Mises (CVM) | Summed squared differences | Overall shape |
| Andersonâ€“Darling (AD) | Tail-weighted CDF distance | Tail changes |
| Earth Mover's Distance (EMD) | Optimal transport cost | Any distributional change |

Results are combined via **majority vote** (â‰¥3/5 tests agree â†’ drift flagged).

**Two detection modes:**
- **Mode I (Consecutive):** compares adjacent windows within the same year â€” detects drift onset
- **Mode II (Corresponding):** compares same-period windows across years â€” confirms sustained drift

**Window levels:** monthly (W=1), quarterly (W=3), semi-annual (W=6), annual (W=12)

---

## Project Structure

```
WinDriftPP_Mode2/              â† Full project root (use Mode1 for C1-C17 only)
â”œâ”€â”€ main.py                    â† Entry point â€” run this
â”œâ”€â”€ core_algorithm/
â”‚   â”œâ”€â”€ config.py              â† All algorithm parameters and dataset definitions
â”‚   â”œâ”€â”€ ecdf.py                â† Empirical CDF computation
â”‚   â”œâ”€â”€ statistical_tests.py   â† KS, Kuiper, CVM, AD, EMD tests
â”‚   â”œâ”€â”€ voting.py              â† 5 voting methods
â”‚   â”œâ”€â”€ windrift_pp.py         â† Core detector: Mode I & II (univariate)
â”‚   â”œâ”€â”€ windrift_pp_multivariate.py  â† Multivariate extension (C23-C30)
â”‚   â””â”€â”€ evaluation.py          â† Detection statistics and flag rates
â”œâ”€â”€ data_generation/           â† Standalone â€” can exclude from deployment
â”‚   â”œâ”€â”€ data_generator.py      â† C1-C17 synthetic univariate
â”‚   â”œâ”€â”€ data_generator_real.py â† C18-C22 real-world univariate
â”‚   â””â”€â”€ data_generator_multivariate.py  â† C23-C30 multivariate
â”œâ”€â”€ visualisation/             â† Standalone â€” can exclude from deployment
â”‚   â””â”€â”€ visualisation.py       â† Charts: overview, ECDF, heatmaps, ablation
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_windrift_pp.py    â† 47 unit tests
â”œâ”€â”€ Datasets/                  â† Generated on first run (or pre-loaded)
â””â”€â”€ Results/                   â† Output tables, plots, logs
```

---

## Quick Start

```bash
# Clone and set up
git clone https://github.com/YOUR-USERNAME/windrift-pp.git
cd windrift-pp
python -m venv venv && source venv/bin/activate   # Windows: venv\Scripts\activate
pip install -r requirements.txt

# Run full pipeline (generates data, runs detection, saves results)
python main.py
```

**Expected runtime:** ~90 seconds for the full C1-C30 pipeline.

To run C1-C17 only (Mode 1):
```bash
# Use the Mode 1 package â€” faster (~30s)
python main.py   # from WinDriftPP_Mode1/
```

---

## Configuration

Edit `core_algorithm/config.py` to change parameters:

```python
WIN_LEV_SIZE  = [1, 3, 6, 12]   # window sizes: monthly/quarterly/semi-annual/annual
MAX_CYC_LEN   = 12               # months per cycle
ALPHA         = 0.05             # significance level
N_OBS         = 30               # observations per monthly column
RANDOM_SEED   = 112
```

Toggle pipeline stages in `main.py`:
```python
REGENERATE_DATA = False   # True = regenerate CSVs from scratch
GENERATE_PLOTS  = False   # True = produce all charts after detection
```

---

## Datasets

### Mode 1 â€” Synthetic Univariate (C1-C17)

| Group | Datasets | Experiment | Description | Drift |
|---|---|---|---|---|
| Exp 1 | C1-C5 | Similar distributions | Y2019 â‰ˆ Y2020 (Â±10â€“20% scale) | No |
| Exp 2 | C6-C10 | Dissimilar distributions | Y2020 reverses Y2019 monthly order | Yes |
| Exp 3 | C11-C13 | Significant statistical change | Skewness, shape, location shifts | Yes |
| Exp 3 | C14-C16 | Detectable characteristic change | Tail width, outlier distribution | Yes |
| Exp 3 | C17 | Ties (repetitive values) | Laplace discretised | No |

### Mode 2 â€” Extended (C18-C30)

| Group | Datasets | Experiment | Description | Drift |
|---|---|---|---|---|
| Exp 4 | C18-C22 | Real-world univariate | NOAA temp, electricity, covertype, insects, air quality | Yes |
| Exp 5 | C23-C25 | Real-world multivariate | Weather station, energy system, ecological sensors | Yes |
| Exp 6 | C26-C27 | SEA concept (abrupt/gradual) | 3 features, boundary shift | Yes |
| Exp 6 | C28-C29 | Agrawal concept (abrupt/gradual) | salary, age, loan distributions | Yes |
| Exp 6 | C30 | Rotating hyperplane | 5 features, gradual rotation | Yes |

Each dataset: **30 observations Ã— 24 monthly columns** (M01-M12 = Y2019, M13-M24 = Y2020).  
Multivariate datasets: one CSV per feature, stored in `Datasets/<CID>/`.

---

## API Usage

### Univariate detection

```python
import sys, pandas as pd
sys.path.insert(0, 'core_algorithm')
from windrift_pp import WinDriftPP

df = pd.read_csv('Datasets/C6.csv')   # 30 rows Ã— 24 columns
detector = WinDriftPP(win_lev_size=[1,3,6,12], max_cyc_len=12, alpha=0.05)
detector.detect(df, dataset_id='C6')
results = detector.to_dataframe()

# Mode II (Corresponding) drift detections
mode2 = results[results['mode'] == 2]
print(f"Drift flags: {(mode2['majority_flag']==1).sum()}/19")
```

### Multivariate detection

```python
from windrift_pp_multivariate import WinDriftPPMultivariate

# features = {feature_name: DataFrame} â€” one DataFrame per feature
features = {
    'temperature': pd.read_csv('Datasets/C23/temperature.csv'),
    'humidity':    pd.read_csv('Datasets/C23/humidity.csv'),
    'pressure':    pd.read_csv('Datasets/C23/pressure.csv'),
}
detector = WinDriftPPMultivariate()
results  = detector.detect(features, dataset_id='C23')
```

### Evaluation

```python
from evaluation import summarise_dataset
summary = summarise_dataset('C6', results)
# Returns: total_comparisons, flags_raised, flag_rate, first_flag_dbcount, MTD,
#          and per-test flag counts (ks_flags, kuiper_flags, cvm_flags, ad_flags, emd_flags)
```

---

## Results (Mode II, Majority Vote)

| Group | Drift injected | Detection Rate |
|---|---|---|
| C1-C5 Similar | No drift | 0-2/19 (â‰¤10% FPR) |
| C6-C10 Dissimilar | Drift | 16-17/19 (84-89% recall) |
| C11-C13 Significant change | Drift | 19/19 (100%) |
| C14-C16 Detectable change | Drift | 13-19/19 |
| C17 Ties | No drift | 4/19 (21% FPR, AD-driven) |
| C18-C22 Real-world univariate | Drift | 13-19/19 |
| C23-C25 Real-world multivariate | Drift | 14-19/19 |
| C26-C30 Synthetic multivariate | Drift | 13-19/19 |

---

## Testing

```bash
cd WinDriftPP_Mode1   # or Mode2
python -m pytest tests/ -v
# Expected: 47 passed
```

---

## Citation

```bibtex
@ARTICLE{naqvi2023windriftpp,
  author={Naqvi, Naureen and Rehman, Sabih ur and Islam, Md Zahidul},
  journal={IEEE Transactions on Artificial Intelligence}, 
  title={WinDrift++:A diversified detector for concept drift}, 
  year={2025},
  volume={},
  number={},
  pages={1-16},
  keywords={Detectors;Concept drift;Time series analysis;Incremental learning;Robustness;Accuracy;Synthetic data;Mathematical models;Ensemble learning;Computational efficiency;Concept Drift Detection;Incremental Learning;Ensemble Methods;Statistical Hypothesis Testing;Data Streams;Non-Stationary Environments},
  doi={10.1109/TAI.2025.3619461}}
}
```

---

## License

MIT License. See [LICENSE](LICENSE).  
This license covers the implementation only. The algorithm is the intellectual property of the original authors â€” please cite the paper in any research use.
